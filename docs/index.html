<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>opacity - スライダーとモーダル（ポップアップ）を併用</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/slick-theme.css">
  <link rel="stylesheet" href="css/slick.css">

  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
  <![endif]-->

<style media="screen">
.sliderWrap {
  position: relative;
  max-width: 930px;
  margin: 0 auto 130px;
}
.slick-slide img {
  width: 100%;
}
.slick-initialized .slick-slide {
  margin: 0 20px;
}
/* 半透明クリック不可設定 */
.isOpacity .slick-slide {
  position: relative;
  transition: all .5s;
  pointer-events: none;
}
.isOpacity .slick-center {
  pointer-events: auto;
}



/* カウンター
--------------------------- */
.slide-counter {
  position: absolute;
  left: 100px;
  bottom: -30px;
  color: #999;
  font-size: 14px;
  font-weight: bold;
}
/* モーダル
--------------------------- */
#js-sliderModalBk {
  display: none;
  position: absolute;
  z-index: 3;
  top: 0;
  left: 0;
  background: rgba(0,0,0,0.7);
}
.sliderModalWrap {
  display: none;
  position: fixed;
  z-index: 3;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  max-width: 780px;
  height: 427px;
  margin: auto;
}
.sliderModal {
  position: relative;
  top: 0;
  left: 0;
  height: 427px;
  margin-bottom: 30px;
  opacity: 1;
}
.sliderModal li {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 700px !important;
  height: 427px;
  background: #fff;
  opacity: 0 !important;
}
.sliderModal li img {
  width: auto;
}
.sliderModal__contents {
  position: absolute;
  top: 100px;
  right: 150px;
}
.sliderModal__btn {
  display: flex;
  position: absolute;
  z-index: 2;
  right: 20px;
  bottom: 20px;
}
.sliderModal__prev,
.sliderModal__next {
  display: inline-block;
  margin: 0 10px;
  cursor: pointer;
}
.sliderModal .modal-active {
  display: block !important;
  z-index: 100 !important;
}
.sliderModal .slick-track {
  position: fixed;
}
.sliderModalWrap .slick-list {
  overflow: visible;
  position: fixed;
}
.modalHide {
  z-index: 1 !important;
}
.sliderModal li.modalShow {
  opacity: 1 !important;
  z-index: 100 !important;
}
.sliderModalWrap .slick-prev,
.sliderModalWrap .slick-next {
  z-index: 110;
  top: 0;
  bottom: 0;
  margin: auto;
}
.isOpacity .slick-slide:not(.slick-center) {
  -webkit-filter: opacity(30%);
  -moz-filter: opacity(30%);
  -o-filter: opacity(30%);
  -ms-filter: opacity(30%);
  filter: opacity(30%);
  transition: 0.2s linear;
}

/* ボタン
----------------------------- */
.modalOpenBtn {
  position: absolute;
  right: 10px;
  bottom: 10px;
  width: 30px;
  padding: 10px;
  box-sizing: border-box;
  background-color: rgba(0,0,0,.3);
}
.slick-prev:before, .slick-next:before {
  display: none;
}
.slick-prev, .slick-next {
  width: 50px;
  background: url("./img/arrowright.png") no-repeat left center;
  background-size: 100%;
}
.slick-prev {
  transform: rotate(-180deg);
}


/* 実装に不要なcss
--------------------------- */
.subTitle {
  max-width: 900px;
  margin: 35px auto 15px;
  padding: 15px 0 15px 20px;
  box-sizing: border-box;
  font-size: 20px;
  font-weight: bold;
  border-left: 7px solid #008FA8;
}




</style>
</head>



<body>
  <div id="js-sliderModalBk"></div><!-- sliderModalBk -->


  <!-- ///////////////////////////////////////////////////////////////// -->

  <div class="subTitle">スライダー × モーダル（fade） - activeを中央表示、それ以外は半透明</div>

  <!-- slider 1 -->
  <div class="sliderWrap">
    <ul class="slider1 slider isOpacity">
      <li>
        <a href="#slider1">
          <img src="img/01.jpg">
          <div class="modalOpenBtn"><img src="img/btn-open.svg"></div>
        </a>
      </li>
      <li>
        <a href="#slider2">
          <img src="img/02.jpg">
          <div class="modalOpenBtn"><img src="img/btn-open.svg"></div>
        </a>
      </li>
      <li>
        <a href="#slider3">
          <img src="img/03.jpg">
          <div class="modalOpenBtn"><img src="img/btn-open.svg"></div>
        </a>
      </li>
      <li>
        <a href="#slider4">
          <img src="img/04.jpg">
          <div class="modalOpenBtn"><img src="img/btn-open.svg"></div>
        </a>
      </li>
      <li>
        <a href="#slider5">
          <img src="img/05.jpg">
          <div class="modalOpenBtn"><img src="img/btn-open.svg"></div>
        </a>
      </li>
      <li>
        <a href="#slider6">
          <img src="img/06.jpg">
          <div class="modalOpenBtn"><img src="img/btn-open.svg"></div>
        </a>
      </li>
    </ul>
    <div class="slide-counter1 slide-counter"><span class="slider1-current"></span> / <span class="slider1-total"></span></div>
  </div><!-- sliderWrap -->

  <div class="sliderModalWrap1 sliderModalWrap">
    <ul class="sliderModal1 sliderModal">
      <li>
        <img src="img/01.jpg">
        <div class="sliderModal__contents">
          contents1
        </div><!-- sliderModal__contents -->
      </li>
      <li>
        <img src="img/02.jpg">
        <div class="sliderModal__contents">
          contents2
        </div><!-- sliderModal__contents -->
      </li>
      <li>
        <img src="img/03.jpg">
        <div class="sliderModal__contents">
          contents3
        </div><!-- sliderModal__contents -->
      </li>
      <li>
        <img src="img/04.jpg">
        <div class="sliderModal__contents">
          contents4
        </div><!-- sliderModal__contents -->
      </li>
      <li>
        <img src="img/05.jpg">
        <div class="sliderModal__contents">
          contents5
        </div><!-- sliderModal__contents -->
      </li>
      <li>
        <img src="img/06.jpg">
        <div class="sliderModal__contents">
          contents6
        </div><!-- sliderModal__contents -->
      </li>
    </ul>
  </div><!-- sliderModalWrap -->




  <!-- ///////////////////////////////////////////////////////////////// -->



  <div class="subTitle">スライダー × モーダル（fade） - activeを中央表示</div>

  <!-- slider 2 -->
  <div class="sliderWrap">
    <ul class="slider2 slider">
      <li>
        <a href="#slider1">
          <img src="img/01.jpg">
          <div class="modalOpenBtn"><img src="img/btn-open.svg"></div>
        </a>
      </li>
      <li>
        <a href="#slider2">
          <img src="img/02.jpg">
          <div class="modalOpenBtn"><img src="img/btn-open.svg"></div>
        </a>
      </li>
      <li>
        <a href="#slider3">
          <img src="img/03.jpg">
          <div class="modalOpenBtn"><img src="img/btn-open.svg"></div>
        </a>
      </li>
      <li>
        <a href="#slider4">
          <img src="img/04.jpg">
          <div class="modalOpenBtn"><img src="img/btn-open.svg"></div>
        </a>
      </li>
      <li>
        <a href="#slider5">
          <img src="img/05.jpg">
          <div class="modalOpenBtn"><img src="img/btn-open.svg"></div>
        </a>
      </li>
    </ul>
    <div class="slide-counter2 slide-counter"><span class="slider2-current"></span> / <span class="slider2-total"></span></div>
  </div><!-- sliderWrap -->

  <div class="sliderModalWrap2 sliderModalWrap">
    <ul class="sliderModal2 sliderModal">
      <li>
        <img src="img/01.jpg">
        <div class="sliderModal__contents">
          contents1
        </div><!-- sliderModal__contents -->
      </li>
      <li>
        <img src="img/02.jpg">
        <div class="sliderModal__contents">
          contents2
        </div><!-- sliderModal__contents -->
      </li>
      <li>
        <img src="img/03.jpg">
        <div class="sliderModal__contents">
          contents3
        </div><!-- sliderModal__contents -->
      </li>
      <li>
        <img src="img/04.jpg">
        <div class="sliderModal__contents">
          contents4
        </div><!-- sliderModal__contents -->
      </li>
      <li>
        <img src="img/05.jpg">
        <div class="sliderModal__contents">
          contents5
        </div><!-- sliderModal__contents -->
      </li>
    </ul>
  </div><!-- sliderModalWrap -->



<!-- ///////////////////////////////////////////////////////////////// -->



<script type="text/javascript" src="js/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="js/slick.min.js"></script>
<script type="text/javascript">


$(function() {

  var SliderInit = function(el,current,total){
    $(el).on('init', function(event, slick) {
      $(current).text(slick.currentSlide + 1); // １を表示
      $(total).text(slick.slideCount); // トータル枚数
    })
    .slick({
      autoplay: true,
      infinite: true,
      slidesToShow: 3,
      slidesToScroll: 1,
      centerPadding: 0,
      centerMode: true
    })
    .on('beforeChange', function(event, slick, currentSlide, nextSlide) {
      $(current).text(nextSlide + 1); // 現在表示を切り替え
    });
  };

  // インスタンス生成
  var slider1 = new SliderInit('.slider1','.slider1-current','.slider1-total');
  var slider2 = new SliderInit('.slider2','.slider2-current','.slider2-total');


  // ------------------------------------------------------------------------------------------


  var SliderModalInit = function(sliderModalSet){
    var $modalTrigger = $(sliderModalSet.trigger);
    var $modalBk = $('#js-sliderModalBk');
    var $modalWrap = $(sliderModalSet.elParent);
    var $modalEl = $(sliderModalSet.el);
    var $modalElLength = $modalEl.length;

    $(sliderModalSet.target).slick({
      autoplay: false,
      fade: true,
      slidesToShow: 1,
      slidesToScroll: 1,
      centerPadding: 0
    });

    $modalTrigger.on('click', function(){
      var $slideIndexSelected = parseInt($(this).prop('href').substr(-1,1)) - 1;
      $modalEl.removeClass('slick-current slick-active');
      $modalEl.removeClass('modalShow').addClass('modalHide');
      $modalEl.eq($slideIndexSelected).addClass('modalShow');

      var $winWidth = $(window).width();
      var $docHeight= $(document).height();
      $modalBk.css({
        width: $winWidth,
        height: $docHeight
      }).fadeIn();
      $modalWrap.fadeIn();

      // モーダル内の prev ボタンをクリック
      $(sliderModalSet.modalPrev).on('click', function(){
        if($slideIndexSelected <= 0) {
          $slideIndexSelected = $modalElLength;
        }
        $slideIndexSelected--;
        $modalEl.removeClass('modalShow');
        $modalEl.eq($slideIndexSelected).addClass('modalShow');
      });

      // モーダル内の next ボタンをクリック
      $(sliderModalSet.modalNext).on('click', function(){
        $slideIndexSelected++;
        if($slideIndexSelected == $modalElLength) {
          $slideIndexSelected = 0;
        }
        $modalEl.removeClass('modalShow');
        $modalEl.eq($slideIndexSelected).addClass('modalShow');
      });
    });

    // モーダル背景をクリック
    $modalBk.on('click', function(){
      $(this).fadeOut();
      $modalWrap.fadeOut();
    });
  };

  // 設定
  var sliderModalSet1 = {
    trigger: '.slider1 li a',
    elParent: '.sliderModalWrap1',
    el: '.sliderModal1 li',
    target: '.sliderModal1',
    modalPrev: '.sliderModalWrap1 .slick-prev',
    modalNext: '.sliderModalWrap1 .slick-next'
  }
  var sliderModalSet2 = {
    trigger: '.slider2 li a',
    elParent: '.sliderModalWrap2',
    el: '.sliderModal2 li',
    target: '.sliderModal2',
    modalPrev: '.sliderModalWrap2 .slick-prev',
    modalNext: '.sliderModalWrap2 .slick-next'
  }

  // インスタンス生成
  var sliderModal1 = new SliderModalInit(sliderModalSet1);
  var sliderModal2 = new SliderModalInit(sliderModalSet2);




});



</script>
</body>
</html>
